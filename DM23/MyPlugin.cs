using System;
using System.Collections.Generic;
using System.ComponentModel.Composition;
using System.IO;
using System.Linq;
using System.Reflection;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace DM23
{
    // Do not forget to update version number and author (company attribute) in AssemblyInfo.cs class
    // To generate Base64 string for Images below, you can use https://www.base64-image.de/
    [Export(typeof(IXrmToolBoxPlugin)),
        ExportMetadata("Name", "Mini CRM from DynamicsMinds 2023"),
        ExportMetadata("Description", "Why this tool? Because I can."),
        // Please specify the base64 content of a 32x32 pixels image
        ExportMetadata("SmallImageBase64", "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"),
        // Please specify the base64 content of a 80x80 pixels image
        ExportMetadata("BigImageBase64", "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"),
        ExportMetadata("BackgroundColor", "Black"),
        ExportMetadata("PrimaryFontColor", "White"),
        ExportMetadata("SecondaryFontColor", "Gray")]
    public class MyPlugin : PluginBase
    {
        public override IXrmToolBoxPluginControl GetControl()
        {
            return new MyPluginControl();
        }

        /// <summary>
        /// Constructor
        /// </summary>
        public MyPlugin()
        {
            // If you have external assemblies that you need to load, uncomment the following to
            // hook into the event that will fire when an Assembly fails to resolve
            // AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(AssemblyResolveEventHandler);
        }

        /// <summary>
        /// Event fired by CLR when an assembly reference fails to load
        /// Assumes that related assemblies will be loaded from a subfolder named the same as the Plugin
        /// For example, a folder named Sample.XrmToolBox.MyPlugin
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="args"></param>
        /// <returns></returns>
        private Assembly AssemblyResolveEventHandler(object sender, ResolveEventArgs args)
        {
            Assembly loadAssembly = null;
            Assembly currAssembly = Assembly.GetExecutingAssembly();

            // base name of the assembly that failed to resolve
            var argName = args.Name.Substring(0, args.Name.IndexOf(","));

            // check to see if the failing assembly is one that we reference.
            List<AssemblyName> refAssemblies = currAssembly.GetReferencedAssemblies().ToList();
            var refAssembly = refAssemblies.Where(a => a.Name == argName).FirstOrDefault();

            // if the current unresolved assembly is referenced by our plugin, attempt to load
            if (refAssembly != null)
            {
                // load from the path to this plugin assembly, not host executable
                string dir = Path.GetDirectoryName(currAssembly.Location).ToLower();
                string folder = Path.GetFileNameWithoutExtension(currAssembly.Location);
                dir = Path.Combine(dir, folder);

                var assmbPath = Path.Combine(dir, $"{argName}.dll");

                if (File.Exists(assmbPath))
                {
                    loadAssembly = Assembly.LoadFrom(assmbPath);
                }
                else
                {
                    throw new FileNotFoundException($"Unable to locate dependency: {assmbPath}");
                }
            }

            return loadAssembly;
        }
    }
}